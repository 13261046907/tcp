<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.rk.mapper.DevDeviceInstanceMapper">

    <select id="selectMataDataById" resultType="java.lang.String">
        select derive_metadata from dev_device_instance where id=#{deviceId};
    </select>

    <select id="selectDeviceIdByAddress" resultType="java.lang.String">
        select id from dev_device_instance where device_address=#{deviceAddress};
    </select>

    <select id="selectTcpTempBySendHex" resultType="java.lang.String">
        SELECT device_id FROM dev_device_instance_tcp_template WHERE instruction_crc = #{sendHex};
    </select>

    <select id="selectChannelByDeviceId" resultType="com.rk.domain.DeviceModel">
        SELECT id,model_id,device_address,channel FROM dev_device_model WHERE model_id = #{modelId} and device_address = #{deviceAddress} ;
    </select>

    <update id="updateDeriveMetadataValueById">
        update dev_device_instance set derive_metadata_value = #{deriveMetadataValue} where id=#{deviceId};
    </update>

    <update id="updateDeviceModelByDeviceId">
        update dev_device_model set channel = #{channel} where model_id=#{modelId} and device_address=#{deviceAddress};
    </update>

    <insert id="insertDeviceModel" keyProperty="id" useGeneratedKeys="true">
        insert into dev_device_model(model_id, device_address, channel)
        values (#{modelId}, #{deviceAddress}, #{channel})
    </insert>
</mapper>
